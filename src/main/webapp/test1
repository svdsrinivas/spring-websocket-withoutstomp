
m_mr_oneamex_c2c.js
//MYCA-US-SPA
try{
if(Bootstrapper.ensMarket === "en-US"){ //Market check to ensure the code is loading for US market
var xCutFile = "";
var pageURL = window.location.href;
var pagePath = window.location.pathname;
window.loadlecode=true;
window.slFlag = true;
window.iscorppage=true;
window.glbver = 20;

if (Bootstrapper.hostName('global',0)) { //xCutFile for E3 PROD
xCutFile = "//online.americanexpress.com/myca/shared/summary/mycaassist/xcut_spa.js?vr=1.0";
} else { //xCutFile for E3 SL
xCutFile = "//slonline.americanexpress.com/myca/shared/summary/mycaassist/xcut_spa.js?vr=1.0";
}

//LP declaration
window.lpTag = window.lpTag || {}; 
window.lpTag.vars = window.lpTag.vars || []; 
window.lpTag.dbs = window.lpTag.dbs || [];
window.lpMTagConfig = window.lpMTagConfig || {};
window.lpTag.sdes = window.lpTag.sdes||[];

window.itmC2C = function(){
try{
if(Bootstrapper.readCookie('amexsessioncookie') !== null){ //To identify Cardmembers
if(pagePath.indexOf("rewards")>-1){ //Execute the code For MR Cardmembers
//section and tagletSection for MR
window.lpTag.section = "us mr en";
window.lpTag.tagletSection = "mr";
}else{ //code for MYCA CardMembers
if(pageURL.indexOf("/help")>-1){ //section value for MYCA Help page
window.lpTag.section = ["us myca en", "help"];
}else{ //section value for all other myca pages
window.lpTag.section = 'us myca en';
}
window.lpTag.tagletSection = 'myca'; //Tagletsection for all MYCA Cardmembers
}
}else{//section and tagletSection for prospect users
window.lpTag.section = "general";
window.lpTag.tagletSection = "general";
}
//Loading ChatLauncher JS(owned by Chat Team)
Bootstrapper.insertScript("//icm.aexp-static.com/content/dam/chat/prod/launcher/chatLauncher.js?20.0");

if(typeof(lpTag.site) ==="undefined"){ //Check to stop loading mtag file if it is already available/loaded on the page.
Bootstrapper.insertScript("//www.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js");
}
}catch(e){
}
};


//Loading xcutFile for Cardmembers if it is not available on the page
if(Bootstrapper.readCookie('amexsessioncookie') !== null && typeof(mycaAssistJSON)==="undefined"){ //For US CardMembers
Bootstrapper.insertScript(xCutFile);
}
itmC2C(); 


//When route changes for MYCA Application
if(Bootstrapper.readCookie('amexsessioncookie') !== null && pagePath.indexOf("rewards") < 0 && typeof(lpTag)!=="undefined"&& typeof(lpTag.taglets)!=="undefined" && typeof(lpTag.taglets.lp_external_js)!=="undefined"){
// Force downloading of correct file for US MYCA (code provided by LP Team)
lpTag.taglets.lp_external_js.init([
{
"id": "scripts",
"value": "https://sales.liveperson.net/visitor/14106077/js/le_myca_us.js"
}
]);

// Put SDEs in correct format for newPage call
var newSDEs = [];
var oldSDEs = lpTag.sdes.get();
for (n in oldSDEs) {
if (!n.match(/impDisplay|pagediv/)){
newSDEs.push(oldSDEs[n][0]);
}
}

// Call newPage, passing in the SDEs.
// setTimeout used to ensure SDEs are captured before calling newPage 
setTimeout(function(){
try{
if(pageURL.indexOf("/help")>-1){
lpTag.newPage(pageURL, {
section : ["us myca en", "help"],
sdes : newSDEs
});
}else{
lpTag.newPage(pageURL, {
section : "us myca en",
sdes : newSDEs
});
}
}catch(e){
}
}, 250); //End of Timeout
}//End of SPA navigation code provided by LP
}//End
}catch(e){
}
=====
travel_uk_c2c.js
===================
try{
var delayCounter = 0;
var omnPageName = "";
//LP object declaration
window.lpTag = window.lpTag || {};
window.lpTag.vars = window.lpTag.vars || [];
window.lpTag.dbs = window.lpTag.dbs || [];
window.lpMTagConfig = window.lpMTagConfig || {};
window.lpTag.sdes = window.lpTag.sdes || [];
window.lpTag.section = 'uk travel en';
window.lpTag.tagletSection = 'uk travel en';
window.lpTag.autoStart = false;
window.unit = "UK-Travel-purchase-path";

//Delay function for omn object availability
addDelay = function() {
try{
  if (typeof omn_hierarchy === "string" || typeof omn === "object") {
    loadLPUKTag();
  } else {
    delayCounter++;
    if (delayCounter <= 30) {
      setTimeout(function() {
        addDelay();
      }, 100);
    }
  }
}catch(e){
}
};
if (typeof omn_hierarchy === "string" || typeof omn === "object") {
  loadLPUKTag();
} else {
  addDelay();
}

function loadLPUKTag() {
try{
  if ((typeof(omn_hierarchy) !== "undefined" && omn_hierarchy.indexOf("UK") >= 0) || (typeof(omn) !== "undefined" && typeof(omn.hierarchy) !== "undefined" && omn.hierarchy.indexOf("UK") >= 0)) {
    var fileHref = "https://icm.aexp-static.com/Internet/SMC/images/Chat/styles.css";
    var ITMCSS = document.createElement("link");
    ITMCSS.setAttribute("rel", "stylesheet");
    ITMCSS.setAttribute("type", "text/css");
    ITMCSS.setAttribute("href", fileHref);
    document.getElementsByTagName("head")[0].appendChild(ITMCSS);

    window.eventsVal = (typeof(omn_events) === "undefined" ? (typeof(omn) === "undefined" ? "" : (typeof(omn.events) === "undefined" ? "" : omn.events)) : omn_events);
    if (typeof(omn_hierarchy) !== "undefined" && (omn_hierarchy.indexOf("UK|Travel|BookTravel|ER|checkout") >= 0 || omn_hierarchy.indexOf("UK|Travel|BookTravel|ER|Thankyou") >= 0)) {
      lpTag.section = "UK-Travel-sales";
    } else if (typeof(omn_hierarchy) !== "undefined" && (omn_hierarchy.indexOf("UK|Travel|BookTravel|ER|travel_support") >= 0 || omn_hierarchy.indexOf("UK|Travel|BookTravel|ER|faq") >= 0)) {
      lpTag.section = "UK-Travel-service";
    } else if (typeof(omn_hierarchy) !== "undefined" && (document.URL.indexOf("/travel/retrieve_booking.cfm") >= 0 || document.URL.indexOf("/service/bookings_view.cfm") >= 0)) {
      lpTag.section = "UK-Travel-service";
    } else if (typeof(omn) !== "undefined") {
      if (typeof(omn.hierarchy) !== "undefined" && (omn.hierarchy.indexOf("UK|Travel|BookTravel|ER|checkout") >= 0 || omn.hierarchy.indexOf("UK|Travel|BookTravel|ER|Thankyou") >= 0)) {
        lpTag.section = "UK-Travel-sales";
      } else if (typeof(omn.hierarchy) !== "undefined" && (omn.hierarchy.indexOf("UK|Travel|BookTravel|ER|travel_support") >= 0 || omn.hierarchy.indexOf("UK|Travel|BookTravel|ER|faq") >= 0)) {
        lpTag.section = "UK-Travel-service";
      } else if ((document.URL.indexOf("/travel/retrieve_booking.cfm") >= 0 || document.URL.indexOf("/service/bookings_view.cfm") >= 0)) {
        lpTag.section = "UK-Travel-service";
      }
    }
    
    if (typeof omn === "object" && typeof omn.pagename === "string") {
      omnPageName = omn.pagename;
    } else if (typeof(omn_pagename) === "string") {
      omnPageName = omn_pagename;
    }
    lpTag.sdes.push({
      "type": "service",
      "service": {
        "topic": omnPageName,
        "category": eventsVal
      }
    });

    window.lpMTagConfig.showGlobalButton = function() {

      $iOA("#c2c_tab").animate({
        bottom: 0
      }, 500, function() {
        $iOA("#c2c_open_closer .c2c_middle_row").animate({
          'padding-bottom': 10
        }, 300);
      });

      $iOA(".click_to_chat #c2c_open_closer .c2c_sprite-images-close").click(function() {
        // console.log(typeof event);
        if (typeof event !== "undefined") {
          lpMTagConfig.stopEvent(event);
        }
        $iOA(".click_to_chat").fadeOut(500);
        lpSendData('session', 'buttonClosed', true);
      });

    };
    (function() {

      var firstTry = true,
        tryAgain;

      var _lpStopTrying = function() {
        clearInterval(tryAgain);
      };

      // Set LivePerson running now the setup is complete
      var startLETag = function() {
        if (lpTag.start) {
          //Setting the isDom var to true because the dom already loaded
          lpTag.isDom = true;
		  lpTag.start();
          _lpStopTrying();
        } else if (firstTry) {
          firstTry = false;
          tryAgain = setInterval(startLETag, 100);
        }
      };
      startLETag();
    })();
    var lpChatDiv1 = document.createElement("div");
    lpChatDiv1.setAttribute("id", "lpButtonChat1");
    var lpChatDiv2 = document.createElement("div");
    lpChatDiv2.setAttribute("id", "lpButtonChat2");
    document.body.appendChild(lpChatDiv1);
    document.body.appendChild(lpChatDiv2);
    Bootstrapper.loadScriptCallback("//qwww.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js");
  }
}catch(e){

}
}
}catch(e){
}
=====================
travel_au_nz_jp_it_mx_ca_c2c.js

try{
var hostName = window.location.hostname;
var delayCounter = 0;
var omnPageName = "";
var eventValue = "";
var omnHierarchy= "";
var lpTagFile = "";
//Below check for initiate environment specific LP Tag file
if(hostName.indexOf('uat') > -1 || hostName.indexOf('-qa') > -1){
  lpTagFile = "//qwww.aexp-static.com/api/axpi/ensighten/ctc-ca-mx-it/le-mtagconfig.js";  
}else{
  lpTagFile = "//www.aexp-static.com/api/axpi/ensighten/ctc-ca-mx-it/le-mtagconfig.js";  
}

loadLPButtonDiv = function(){
try{
//Create a div for injecting chat button by LP	
var lpChatButton = document.createElement("div");
lpChatButton.setAttribute("id", "lpButtonChat");
document.body.appendChild(lpChatButton);
//Load Lp chat button styles 
var fileHref = "https://icm.aexp-static.com/Internet/SMC/images/Chat/styles.css";
var ITMCSS = document.createElement("link");
ITMCSS.setAttribute("rel", "stylesheet");
ITMCSS.setAttribute("type", "text/css");
ITMCSS.setAttribute("href", fileHref);
document.getElementsByTagName("head")[0].appendChild(ITMCSS);

window.lpMTagConfig.showGlobalButton = function() { 
try{
if(typeof IOA !== "undefined"){
$iOA( "#c2c_tab" ).animate({
    bottom: 0
}, 500, function() {
    $iOA( "#c2c_open_closer .c2c_middle_row" ).animate({
        'padding-bottom': 10
    }, 300);
});
$iOA(".click_to_chat #c2c_open_closer .c2c_sprite-images-close").click(function () {
    // console.log(typeof event);
    if (typeof event !== "undefined") {
        lpMTagConfig.stopEvent(event);
    }
    $iOA(".click_to_chat").fadeOut(500);
    lpSendData('session','buttonClosed',true);
});
}
}catch(err){
}
};
}catch(err){
}
};

setOmnData = function(){  // This method is used for reading omn data from the page 
try{
if(typeof omn === "object" && typeof omn.hierarchy === "string"){
  omnHierarchy = omn.hierarchy;
}else if(typeof omn_hierarchy === "string"){
  omnHierarchy = omn_hierarchy;
}else if(typeof s !== "undefined" && typeof s.pageName !== "undefined"){
  omnHierarchy = s.pageName;
}
if(typeof omn === "object" && typeof(omn.pagename) === "string"){
   omnPageName = omn.pagename;
}else if(typeof(omn_pagename) !== "undefined") {
   omnPageName = omn_pagename;
}else if(typeof s === "object"){
  omnPageName = s.pageName;
}
if(typeof omn === "object" && typeof(omn.events) !== "undefined"){
   eventValue = omn.events;
}else if(typeof(omn_events) !== "undefined"){
    eventValue = omn_events;  
}

//send omn data to LP system 
if(typeof lpTag.sdes === "object"){
lpTag.sdes.push(
{
"type": "service", 
"service": {
  "topic": omnPageName,  
  "category": eventValue,
  "serviceId": omnHierarchy
}
}
);
}
loadLPButtonDiv();
}catch(err){

}
};
addOmnDataDelay = function(){//This method looks for omn details and wait maximum 5 secs 
try{
if(typeof omn_hierarchy === "string" || typeof omn === "object"){
    setOmnData();    
}else{
    delayCounter++;
    if(delayCounter <= 50){
        setTimeout(function(){addOmnDataDelay();}, 100);
    }else{
     setOmnData();
    }
}
}catch(err){	
}
};

//Declare LP variables
window.lpTag = window.lpTag || {}; 
window.lpTag.vars = window.lpTag.vars || []; 
window.lpTag.dbs = window.lpTag.dbs || [];
window.lpMTagConfig = window.lpMTagConfig || {};
window.lpTag.sdes = window.lpTag.sdes||[];
//Checks for market type and initiate section & tagletSection variables for injecting market specific button on the application
if(typeof(Bootstrapper.ensMarket)!=="undefined" && Bootstrapper.ensMarket==="nz_en"){
window.lpTag.section = 'nz travel en';
window.lpTag.tagletSection = 'nz travel en';
}else if(typeof(Bootstrapper.ensMarket)!=="undefined" && Bootstrapper.ensMarket==="au_en"){
window.lpTag.section = 'au travel en';
window.lpTag.tagletSection = 'au travel en';
}else if(typeof(Bootstrapper.ensMarket)!=="undefined" && Bootstrapper.ensMarket==="jp_ja"){
window.lpTag.section = 'jp travel jp';
window.lpTag.tagletSection = 'jp travel jp';
}else if(typeof(Bootstrapper.ensMarket)!=="undefined" && Bootstrapper.ensMarket==="mx_es"){
lpTag.section = 'MexicoTravelSP';
lpTag.tagletSection = 'MexicoTravelSP';
}else if(typeof(Bootstrapper.ensMarket)!=="undefined" && Bootstrapper.ensMarket==="it_it"){ 
lpTag.section = 'ItalyTravelIT';
lpTag.tagletSection = 'ItalyTravelIT';
}else if(typeof(Bootstrapper.ensMarket)!=="undefined" && Bootstrapper.ensMarket==="ca_en"){
lpTag.section = 'CanadaTravelEN';
lpTag.tagletSection = 'CanadaTravelEN';
}else if(typeof(Bootstrapper.ensMarket)!=="undefined" && Bootstrapper.ensMarket==="ca_fr"){
lpTag.section = 'CanadaTravelFR';
lpTag.tagletSection = 'CanadaTravelFR';
}
Bootstrapper.insertScript(lpTagFile); // Load LP mTag file

if(typeof omn_hierarchy === "string" || typeof omn === "object"){
    setOmnData();
}else{
    addOmnDataDelay();
}
}catch(err){	
}

===========================

travel-us-cartPage-c2c.js

try{
var hostName=window.location.hostname;
var pageNameflag = false;
var omnPageName = "";
var omnHierarchy = "";
var lpPageName = "";
var omnintercheck = "";
var customerType = "standard";
var delayCounterCart = 0;
var lpTagFile = "";
var sessionCookie = Bootstrapper.readCookie("amexsessioncookie");
if(typeof(Bootstrapper.ensEnv) !== "undefined" && Bootstrapper.ensEnv == "2"){
 lpTagFile = "//qwww.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js";
}else{
 lpTagFile = "//www.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js";
}
window.lpTag = window.lpTag || {}; 
window.lpTag.vars = window.lpTag.vars || []; 
window.lpTag.dbs = window.lpTag.dbs || [];
window.lpMTagConfig = window.lpMTagConfig || {};
window.lpTag.sdes = window.lpTag.sdes||[];
window.lpTag.section = 'us travel en';
window.lpTag.tagletSection = 'travel';

Bootstrapper.insertScript("//www.aexp-static.com/api/axpi/ioa/js/iOAjquery1.6.3.min.js"); // Required for Vendor hosted pages

checkOmnVariables = function(){
if(typeof omn_hierarchy === "string" || typeof omn === "object"){
    callLpCode();    
} else{
    delayCounterCart++;
    if (delayCounterCart <= 50) {
        setTimeout(function(){checkOmnVariables();}, 100);
    }
}
};

window.callLpCode = function() {
try{
//Load Lp chat button styles	
var fileHref = "https://icm.aexp-static.com/Internet/SMC/images/Chat/styles.css";
var LPCSS = document.createElement("link");
LPCSS.setAttribute("rel", "stylesheet");
LPCSS.setAttribute("type", "text/css");
LPCSS.setAttribute("href", fileHref);
document.getElementsByTagName("head")[0].appendChild(LPCSS);
//Inject div for injecting LP chat button 
var lpChatGlobalDiv = document.createElement("div");
lpChatGlobalDiv.setAttribute("id", "globalButtonDiv");
document.body.appendChild(lpChatGlobalDiv);

if(typeof(omn_pagename) !== "undefined"){
    omnPageName = omn_pagename;
} else if(typeof(omn) !== "undefined" && typeof(omn.pagename) !== "undefined"){
    omnPageName = omn.pagename;
} else if(typeof(s) !== "undefined" && typeof(s.pageName) !== "undefined"){
    omnPageName = s.pageName;
} else {
    omnPageName = "NotAvailble";
}

if(typeof(omn_hierarchy) !== "undefined"){
	omnHierarchy = omn_hierarchy;
} else if(typeof(omn) !== "undefined" && typeof(omn.hierarchy) !== "undefined"){
    omnHierarchy = omn.hierarchy;
}else{
	omnHierarchy = "NotAvailble";
}
if(omnPageName === "NotAvailble"){
	lpPageName = omnHierarchy+"|"+omnPageName;
} else {
	lpPageName = omnPageName;
}

if(typeof lpPageName !== "" ){
if(lpPageName.indexOf("Platinum")>-1 && sessionCookie!==null){
customerType="platinum";
}
}
//send omn data to LP system 
lpTag.section = "US-Travel-sales"; 
if(typeof lpTag.sdes === "object"){
lpTag.sdes.push(
{
"type": "service", 
"service": {
"topic": lpPageName
},
 "type": "ctmrinfo",
 "info": {
           "ctype": customerType
        }
}
);
} 
  
//var inavlog = typeof(iNavUserLoggedIn) !== "undefined" && iNavUserLoggedIn === true;
//console.log("inavlogvariable::"+inavlog);
//Load lp mTag file
Bootstrapper.insertScript(lpTagFile);
}catch(err){}
};
    
if (typeof(omn_pagename) === "undefined" || typeof(omn) === "undefined") {
	checkOmnVariables();  
} else{
	callLpCode();
}

 Bootstrapper.omnvarupdate=function(){
try{
if(typeof(omn) !== "undefined" && typeof(omn.pagename) !== "undefined"){
omnPageName = omn.pagename;
pageNameflag = false;
}
else if(typeof(omn_pagename) !== "undefined"){
omnPageName = omn_pagename;
pageNameflag = false;
}else if(typeof(s) !=="undefined" && typeof(s.pageName) !== "undefined"){
omnPageName = s.pageName;
pageNameflag = true;
} else {
omnPageName = "NotAvailble";
}
if(typeof(omn) !== "undefined" && typeof(omn.hierarchy) !== "undefined"){
omnHierarchy = omn.hierarchy;
}else if(typeof(omn_hierarchy) !== "undefined"){
omnHierarchy = omn_hierarchy;
} else {
omnHierarchy = "NotAvailble";
}

if(omnPageName === "NotAvailble"){
lpPageName = omnHierarchy+"|"+omnPageName;
} else {
lpPageName = omnPageName;
}
// Send data to Lp system
if(typeof lpTag.sdes === "object"){
lpTag.sdes.push(
{
"type": "service", 
"service": {
"topic": lpPageName
},
"type": "ctmrinfo",
"info": {
   "ctype": customerType
}
}
);
}
}catch(err){}
};   
Bootstrapper.addlistenrstobuttons = function(button_idname,idxnum) {
try{
      function addlistenrs(button_idname,idxnum){
          var id = document.querySelectorAll(button_idname)[idxnum];
            if(id !== undefined && id !== null && id !== ""){
            Bootstrapper.unobtrusiveAddEvent(id,"onclick",function(){
             //console.log("button onclick::"+id);
            window.setTimeout(function(){Bootstrapper.omnvarupdate();},3000);});
        }
      }
      if(idxnum === 5 && button_idname === ".button-edit._jq-accordion-edit"){
             for(var j=0;j<idxnum;j++){
                // console.log("edit button::"+j);
                 addlistenrs(button_idname,j);
             }
        }else if(idxnum === 0){
              for(var i=0;i<button_idname.length;i++){
                 // console.log(button_idname[i]+"::save button::"+idxnum);
                  addlistenrs(button_idname[i],idxnum);
                }
         }else if(idxnum === 1){
             //console.log(button_idname+"::Payment save button::"+idxnum);
              addlistenrs(button_idname,idxnum);
         }
}catch(err){}
};
//Sending section level details to Lp from the Cart page
//Travel insurance - Information save button,Preferred seat - Insurance no save button,Preferred seat - Insurance Yes Enroll Agree button,
//Preferred seat - Insurance Yes Disagree button,Payment information - seat skip selection button,Payment information - seat selection save button
var buttoninforArr=[".button-save._jq-submit-button","#trip_insurance_no_submit","#enroll","#do-not-enroll",".skip-seats._jq-noThanks",".save-link.seats-save._jq-seats-save"];
//All buttons
var idxnumsArr=[0,1,5];
Bootstrapper.addlistenrstobuttons(buttoninforArr,idxnumsArr[0]);
//All edit button
Bootstrapper.addlistenrstobuttons(".button-edit._jq-accordion-edit",idxnumsArr[2]);
//Booking - Payment - Pay with points/user your cards - save button
Bootstrapper.addlistenrstobuttons(".button-save.clear._jq-submit-button",idxnumsArr[1]);

}catch(err){}

===========================

travel-us-c2c.js

try{
var hostName=window.location.hostname;
var omnPageName = "";
var omnHierarchy = "";
var lpPageName = "";
var omnintercheck = "";
var customerType = "standard";
var lpTagFile = "";
var delayCounter = 0;
var sessionCookie = Bootstrapper.readCookie("amexsessioncookie");
//Below check for initiate environment specific LP Tag file
if((typeof(Bootstrapper.ensEnv) !== "undefined" && Bootstrapper.ensEnv == "2") || Bootstrapper.hostName("icm",0) || Bootstrapper.hostName("aeti-qa",0) || Bootstrapper.hostName("184.106.144.4",0)){
lpTagFile = "//qwww.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js";  
}else{
lpTagFile = "//www.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js";  
}

window.lpTag = window.lpTag || {}; 
window.lpTag.vars = window.lpTag.vars || []; 
window.lpTag.dbs = window.lpTag.dbs || [];
window.lpMTagConfig = window.lpMTagConfig || {};
window.lpTag.sdes = window.lpTag.sdes||[];
if(!(window.location.pathname.indexOf("foreign-exchange") > -1 || window.location.pathname.indexOf("travelers-cheques") > -1 || window.location.pathname.indexOf("travel-insurance/home.do") >-1)){
window.lpTag.section = 'us travel en';
window.lpTag.tagletSection = 'travel';
}

if(hostName.indexOf('iseatz') > -1 || hostName.indexOf('amextravel') > -1){// only load for Vendor hosted pages
Bootstrapper.insertScript("//www.aexp-static.com/api/axpi/ioa/js/iOAjquery1.6.3.min.js");
}
window.callLpCode = function(){
try{
//Inject div for injecting LP chat button 
var lpChatGlobalDiv = document.createElement("div");
lpChatGlobalDiv.setAttribute("id", "globalButtonDiv");
document.body.appendChild(lpChatGlobalDiv);
//Load Lp chat button styles 
var fileHref = "https://icm.aexp-static.com/Internet/SMC/images/Chat/styles.css";
var LPCSS = document.createElement("link");
LPCSS.setAttribute("rel", "stylesheet");
LPCSS.setAttribute("type", "text/css");
LPCSS.setAttribute("href", fileHref);
document.getElementsByTagName("head")[0].appendChild(LPCSS);
//Load LP mtag file
Bootstrapper.insertScript(lpTagFile); 

if(typeof(omn_pagename) !== "undefined" ){
omnPageName = omn_pagename;    
}else if(typeof(omn) !== "undefined" && typeof(omn.pagename) !== "undefined"){
omnPageName = omn.pagename;    
}else if(typeof(s) !== "undefined" && typeof(s.pageName) !== "undefined"){
omnPageName = s.pageName;	 
}else {
omnPageName = "NotAvailble";
}

if(typeof(omn_hierarchy) !== "undefined"){
omnHierarchy = omn_hierarchy;
} else if(typeof(omn) !== "undefined" && typeof(omn.hierarchy) !== "undefined"){
omnHierarchy = omn.hierarchy;
}else{
omnHierarchy = "NotAvailble";
}

if(omnPageName === "NotAvailble"){
lpPageName = omnHierarchy+"|"+omnPageName;
} else {
lpPageName = omnPageName;
}

if(lpPageName.indexOf('Checkout') > -1 || lpPageName.indexOf('checkout') > -1) {    
lpTag.section = "US-Travel-sales";    
}else if(lpPageName.indexOf('MyTrips') > -1 || lpPageName.indexOf('Profile') > -1 || lpPageName.indexOf('MRLanding') > -1 ||lpPageName.indexOf('Delta') > -1 || lpPageName.indexOf('faq')  > -1){
lpTag.section = "US-Travel-service";    
} else if(typeof(s) !== "undefined" && typeof(s.pageName) !== "undefined" && s.pageName.indexOf('travel-notices-terms-and-conditions.html') > -1 ){
lpTag.section = "US-Travel-sales"; 
lpPageName = s.pageName;
} else if(window.location.pathname === "/my-trips" || window.location.pathname === "/my-profile"){
lpTag.section = "US-Travel-service";
}else {
lpTag.section = "US-Travel-purchase-path";
}

if(typeof lpPageName !== "" ){
if(lpPageName.indexOf("Platinum")>-1 && sessionCookie!==null){
customerType="platinum";
}
}
//send omn data to LP system 
if(typeof lpTag.sdes === "object"){
 lpTag.sdes.push(
{
"type": "service", 
"service": {
"topic": lpPageName
}, 
"type": "ctmrinfo",
"info": {
	   "ctype": customerType
	}

}
);
}
}catch(err){}
};

checkOmnVariables = function(){ //This method looks for omn details and wait maximum 5 secs 
try{
if(typeof omn_hierarchy === "string" || typeof omn === "object"){
callLpCode();    
} else{
delayCounter++;
if (delayCounter <= 50) {
	setTimeout(function(){checkOmnVariables();}, 100);
}
}
}catch(err){}
};

if(window.location.pathname.indexOf("foreign-exchange") > -1 || window.location.pathname.indexOf("travelers-cheques") > -1 || window.location.pathname.indexOf("travel-insurance/home.do") >-1){
Bootstrapper.insertScript(lpTagFile); // Load only script file for above context paths
}else if(typeof omn_hierarchy === "string" || typeof omn === "object"){
callLpCode();
}else{
checkOmnVariables();
}

//Below method gets executed only for Platinum customers of Traverl HP and it is being invoked by Tech team
window.sendPageName = function(appPageName){
try{
var newPageName = "";
var newPageHierarchy = "";
if(appPageName !== ""){
newPageName = appPageName;
}else{
if(typeof omn === "object" && typeof(omn.pagename) === "string")
	newPageName = omn.pagename;
}
if(typeof omn === "object" && typeof omn.hierarchy === "string")
newPageHierarchy = omn.hierarchy;
var lpNewPageName = newPageHierarchy+"|"+newPageName;  
//Send new page details to LP system
lpTag.newPage(window.location.href, {
section : [lpTag.section], // OR whatever value is currently set on the page. You can use the value of lpTag.section here if you like.
sdes : [{
'type': 'service',
'service': {
	'topic': lpNewPageName
}
},{
'type': 'ctmrinfo',
'info': {
  'ctype': 'platinum'
}
}]
}); 
}catch(err){}
};
}catch(err){	
}

======================================

eapply_canada_c2c.js

var hostName = window.location.hostname;
var pathName = window.location.pathname;
var pageURL = window.location.href;
var timerCount = 0;
var ioaLauncher = "";
var lpTagScript = "";
var ioaJquery = "";
var PageURLCounter = 0;

function newPage() {
  //on page load - When overlay is opened
  if (pageURL.indexOf("begin.do") > -1) {
    lpTag.newPage(pageURL, {
      section: ["ca acq en", "overlay"]
    });

    //When user clicks "Get Started" button

    $(".getStartedlink").live("click", function() {
      lpTag.newPage(pageURL, {
        section: ["ca acq en", "StartApp"]
      });

    });
    var itm_startButton = document.getElementsByClassName("StartApplicationButtonDiv")[0];
    if (typeof(itm_startButton) !== "undefined" && itm_startButton !== "" && itm_startButton !== null) {
      var itm_getStarted = itm_startButton.childNodes[1];
      if (typeof(itm_getStarted) !== "undefined" && itm_getStarted !== "" && itm_getStarted !== null) {


        itm_getStarted.addEventListener("click", function() {
          console.log("inside addEventListener method");
          lpTag.newPage(pageURL, {
            section: ["ca acq en", "StartApp"]
          });
        });
      }
    }
}



  //When user lands on Review page
  if (pageURL.indexOf("next.do") > -1) {
    lpTag.newPage(pageURL, {
      section: ["ca acq en", "App:Review"]
    });
    //When user lands on TnC page
    var itm_TnC = document.getElementById("reviewContinue");
    if (typeof(itm_TnC) !== "undefined" && itm_TnC !== "" && itm_TnC !== null) {
      Bootstrapper.unobtrusiveAddEvent(itm_TnC, 'onclick', function() {
        lpTag.newPage(pageURL, {
          section: ["ca acq en", "App:TnC"]
        });
      });
    }
  } else if (pageURL.indexOf("decision.do") > -1) { //When user lands on decision page
    lpTag.newPage(pageURL, {
      section: ["ca acq en", "App:Decision"]
    });
  } else if (pageURL.indexOf("thankyou.do") > -1) { // When user lands on TY page
    lpTag.newPage(pageURL, {
      section: ["ca acq en", "App:ThankYou"]
    });
  }
}

function sendPageNameToLE() {
  if (typeof lpTag.newPage !== "undefined") {
    newPage();
  } else {
    PageURLCounter++;
    if (PageURLCounter <= 30) {
      setTimeout(function() {
        sendPageNameToLE();
      }, 100);
    }
  }
}

//Req #11358 :: Updated deployment with Live Engagement code of LP
window.lpTag = window.lpTag || {};
window.lpTag.vars = window.lpTag.vars || [];
window.lpTag.dbs = window.lpTag.dbs || [];
window.lpMTagConfig = window.lpMTagConfig || {};
window.lpTag.sdes = window.lpTag.sdes || [];
window.lpTag.section = 'ca acq en';
window.lpTag.tagletSection = 'acquisitions';

if (hostName.indexOf("e1qglobal") === 0) {
  ioaLauncher = "//dstatic.dev.ipc.us.aexp.com/api/axpi/ioa/launcher/intlLiveChat.js";
  lpTagScript = "//dstatic.dev.ipc.us.aexp.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js";
  ioaJquery = "//dstatic.dev.ipc.us.aexp.com/api/axpi/ioa/js/iOAjquery1.6.3.min.js";
} else if (hostName.indexOf("www") === 1 || hostName.indexOf("e2qglobal") === 0) {
  ioaLauncher = "//qwww.aexp-static.com/api/axpi/ioa/launcher/intlLiveChat.js";
  lpTagScript = "//qwww.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js";
  ioaJquery = "//qwww.aexp-static.com/api/axpi/ioa/js/iOAjquery1.6.3.min.js";
} else if (hostName.indexOf("www") === 0 || hostName.indexOf("global") === 0) {
  ioaLauncher = "//www.aexp-static.com/api/axpi/ioa/launcher/intlLiveChat.js?vr1.0";
  lpTagScript = "//www.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js";
  ioaJquery = "//www.aexp-static.com/api/axpi/ioa/js/iOAjquery1.6.3.min.js";
}

lpTag.sdes.push({
  "type": "ctmrinfo",
  "info": {
    "cstatus": "canada acquisitions"
  }
});

function checkIOAVariable() {
  if (typeof($iOA) !== "undefined") {
    Bootstrapper.insertScript(ioaLauncher);
    Bootstrapper.insertScript(lpTagScript);
    sendPageNameToLE();
  } else {
    timerCount++;
    if (timerCount <= 50) {
      setTimeout(function() {
        checkIOAVariable();
      }, 100);
    } else {
      Bootstrapper.insertScript(ioaLauncher);
      Bootstrapper.insertScript(lpTagScript);
      sendPageNameToLE();
    }
  }
}
Bootstrapper.insertScript(ioaJquery);
if (typeof($iOA) === "undefined") {
  setTimeout(function() {
    checkIOAVariable();
  }, 100);
} else {
  Bootstrapper.insertScript(ioaLauncher);
  Bootstrapper.insertScript(lpTagScript);
  sendPageNameToLE();
}

=====================
gcp_cardapp_us_c2c.js

var mmpIdValue = "";
var hierarchy = "";
var pageName = "";
var pmc = "";
var productName = "";
var appDecision = "";
var PCN = "";
var LERnumCode = "";
var LEStartPageURL = "";
var userType = "";
var lpURL = "";
if (Bootstrapper.ensEnv == "1") {
  lpURL = "//dstatic.dev.ipc.us.aexp.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js";
} else if (Bootstrapper.ensEnv === "2" || Bootstrapper.ensEnv === "3") {
  lpURL = "//www.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js";
} else if (Bootstrapper.ensEnv == "3") {
  lpURL = "//www.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js";
}

if (Bootstrapper.readCookie('amexsessioncookie') !== null) {
  userType = "Card Member Logged In";
} else if (Bootstrapper.readCookie('blueboxpublic') !== null) {
  userType = "Card Member Cookied";
} else {
  userType = "Prospect";
}

if (typeof window.Visitor === "function") {
  if (typeof visitor != "undefined") {
    if (typeof visitor.getMarketingCloudVisitorID != "undefined") {
      mmpIdValue = visitor.getMarketingCloudVisitorID();
    }
  }
} else {
  mmpIdValue = Bootstrapper.readCookie('AMCV_combined');
  if (mmpIdValue === null) {
    mmpIdValue = "";
  } else {
    mmpIdValue = mmpIdValue.substring(0, mmpIdValue.indexOf('%'));
  }
}

function generateRandomNumber() {
  var LERnum = Math.floor(Math.random() * 100);
  if (!Bootstrapper.checkCookie("legcpnum")) {
    if (LERnum < 33) {
      LERnumCode = "0";
      Bootstrapper.createCookie("legcpnum", "0", 365, ".americanexpress.com");
    } else if (LERnum < 66) {
      LERnumCode = "1";
      Bootstrapper.createCookie("legcpnum", "1", 365, ".americanexpress.com");
    } else {
      LERnumCode = "2";
      Bootstrapper.createCookie("legcpnum", "2", 365, ".americanexpress.com");
    }
  } else {
    LERnumCode = Bootstrapper.readCookie("legcpnum");
  }
}

function sendStartPageNameURL() {
  var urlString = window.location.href;
  var LEPageName = "";
  if (urlString.indexOf("?") > -1)
    LEPageName = urlString.substring(0, urlString.indexOf("?"));
  else
    LEPageName = urlString;
  if (!Bootstrapper.checkCookie("gcpshop") && !Bootstrapper.checkCookie("gcpapply")) {
    Bootstrapper.createCookie("gcpapply", LEPageName, 0, ".americanexpress.com");
    LEStartPageURL = LEPageName;
  } else if (Bootstrapper.checkCookie("gcpshop")) {
    LEStartPageURL = Bootstrapper.readCookie("gcpshop");
  } else if (Bootstrapper.checkCookie("gcpapply")) {
    LEStartPageURL = Bootstrapper.readCookie("gcpapply");
  }
}
sendPageData = function() {
  generateRandomNumber();
  sendStartPageNameURL();
  pageName = digitalData.page.pageInfo.pageName;
  var country = subCategory1 = subCategory2 = subCategory3 = businessUnit = primaryCategory = "";
  if (typeof digitalData.page.pageInfo.country !== "undefined" && digitalData.page.pageInfo.country !== "") {
    country = digitalData.page.pageInfo.country;
  }
  if (typeof digitalData.page.category !== "undefined" && digitalData.page.category !== "") {
    var category = digitalData.page.category;
    if (typeof category.businessUnit !== "undefined" && typeof category.primaryCategory !== "undefined") {
      businessUnit = category.businessUnit;
      primaryCategory = category.primaryCategory;
    }
    if (typeof category.subCategory1 !== "undefined" && category.subCategory1 !== "") subCategory1 = category.subCategory1;
    if (typeof category.subCategory2 !== "undefined" && category.subCategory2 !== "") subCategory2 = category.subCategory2;
    if (typeof category.subCategory3 !== "undefined" && category.subCategory3 !== "") subCategory3 = category.subCategory3;
    if (subCategory1 === "" && subCategory2 === "" && subCategory3 === "")
      hierarchy = country + "|" + businessUnit + "|" + primaryCategory;
    else if (subCategory2 === "" && subCategory3 === "")
      hierarchy = country + "|" + businessUnit + "|" + primaryCategory + "|" + subCategory1;
    else if (subCategory3 === "")
      hierarchy = country + "|" + businessUnit + "|" + primaryCategory + "|" + subCategory1 + "|" + subCategory2;
    else
      hierarchy = country + "|" + businessUnit + "|" + primaryCategory + "|" + subCategory1 + "|" + subCategory2 + "|" + subCategory3;
  }



  lpTag.sdes.push({
    "type": "ctmrinfo", //MANDATORY
    "info": {
      "cstatus": pageName, //Pass Page Name here
      "ctype": userType, //Pass Customer Type here
      "customerId": hierarchy, //Pass Omniture Hierarchy here
      "imei": mmpIdValue, //Pass Omniture ID here
      "role": LEStartPageURL, //Pass Entry URL here
      "storeNumber": LERnumCode //Pass Random Number here
    }
  });
};

sendPageNameToLP = function() {
  lpTag.sdes.push({
    "type": "ctmrinfo", //MANDATORY
    "info": {
      "cstatus": pageName
    }
  });
};

sendPCNAndDecision = function() {
  if (typeof digitalData.event !== "undefined" && digitalData.event.length > 0 && digitalData.event[0].productInfo !== "undefined" && digitalData.event[0].productInfo.length > 0) {
    pmc = digitalData.event[0].productInfo[0].pmc;
    productName = digitalData.event[0].productInfo[0].productName;
  }
  if (typeof digitalData.page.attributes !== "undefined" && typeof digitalData.page.attributes.appDecision !== "undefined") {
    appDecision = digitalData.page.attributes.appDecision;
  }
  if (typeof digitalData.user !== "undefined" && typeof digitalData.user.pcnNumber === "string" && digitalData.user.pcnNumber !== "") {
    PCN = digitalData.user.pcnNumber;
  }
  lpTag.sdes.push({
    "type": "lead", //MANDATORY
    "lead": {
      "topic": appDecision, //Pass App Decision here
      "currency": productName, //Pass Card Name here
      "leadId": pmc //Pass 3 Digit Card ID here
    }
  });
};

loadLPVariable = function() {
  window.lpTag = window.lpTag || {};
  window.lpMTagConfig = window.lpMTagConfig || {};
  window.lpTag.vars = window.lpTag.vars || [];
  window.lpTag.dbs = window.lpTag.dbs || [];
  window.lpTag.sdes = window.lpTag.sdes || [];
  window.lpTag.section = 'corporate-acquisitions';
  Bootstrapper.insertScript(lpURL);
};

try {
  if (typeof digitalData !== "undefined" && typeof digitalData.page !== "undefined" && digitalData.page.pageInfo !== "undefined" && typeof digitalData.page.pageInfo.pageName !== "undefined" && digitalData.page.pageInfo.pageName !== "") {
    appPageName = digitalData.page.pageInfo.pageName;
    if (appPageName === "StartApp") {
      loadLPVariable();
      sendPageData();
    } else if (appPageName.indexOf("Ineligible") > -1) {
      pageName = appPageName;
      sendPageNameToLP();
    } else if (appPageName === "CompanyInfo") {
      pageName = appPageName;
      sendPageNameToLP();
    } else if (appPageName === "PersonalInfo") {
      pageName = appPageName;
      sendPageNameToLP();
    } else if (appPageName === "Review") {
      pageName = appPageName;
      sendPageNameToLP();
    } else if (appPageName === "ThankYou") {
      pageName = appPageName;
      sendPageNameToLP();
      sendPCNAndDecision();
    }
  }
} catch (err) {
  console.log("err" + err);
}

=================

gcp_shoppages_us_c2c.js

var pathName = window.location.pathname;
if (pathName.indexOf("/card-member/") < 0) {
  var mmpIdValue = "";
  var hierarchy = "";
  var pageName = "";
  var LERnumCode = "";
  var LEStartPageURL = "";
  var userType = "";
  var omnObjExistCount = 0;
  var lpURL = "";
  var chatWidgetCSS = "";
  if (Bootstrapper.ensEnv == "1") {
    lpURL = "//dstatic.dev.ipc.us.aexp.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js";
  } else if (Bootstrapper.ensEnv == "2") {
    lpURL = "//qwww.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js";
  } else if (Bootstrapper.ensEnv == "3") {
    lpURL = "//www.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js";
  }

  if (Bootstrapper.readCookie('amexsessioncookie') !== null) {
    userType = "Card Member Logged In";
  } else if (Bootstrapper.readCookie('blueboxpublic') !== null) {
    userType = "Card Member Cookied";
  } else {
    userType = "Prospect";
  }

  if (typeof window.Visitor === "function") {
    if (typeof visitor != "undefined") {
      if (typeof visitor.getMarketingCloudVisitorID != "undefined") {
        mmpIdValue = visitor.getMarketingCloudVisitorID();
      }
    }
  } else {
    mmpIdValue = Bootstrapper.readCookie('AMCV_combined');
    if (mmpIdValue === null) {
      mmpIdValue = "";
    } else {
      mmpIdValue = mmpIdValue.substring(0, mmpIdValue.indexOf('%'));
    }
  }

  generateRandomNumber = function() {
    var LERnum = Math.floor(Math.random() * 100);
    if (!Bootstrapper.checkCookie("lenum")) {
      if (LERnum < 33) {
        LERnumCode = "0";
        Bootstrapper.createCookie("lenum", "0", 365, ".americanexpress.com");
      } else if (LERnum < 66) {
        LERnumCode = "1";
        Bootstrapper.createCookie("lenum", "1", 365, ".americanexpress.com");
      } else {
        LERnumCode = "2";
        Bootstrapper.createCookie("lenum", "2", 365, ".americanexpress.com");
      }
    } else {
      LERnumCode = Bootstrapper.readCookie("lenum");
    }
  };

  sendStartPageNameURL = function() {
    var urlString = window.location.href;
    var LEPageName = "";
    if (urlString.indexOf("?") > -1)
      LEPageName = urlString.substring(0, urlString.indexOf("?"));
    else
      LEPageName = urlString;
    if (!Bootstrapper.checkCookie("gcpshop") && !Bootstrapper.checkCookie("gcpapply")) {
      Bootstrapper.createCookie("gcpshop", LEPageName, 0, ".americanexpress.com");
      LEStartPageURL = LEPageName;
    } else if (Bootstrapper.checkCookie("gcpshop")) {
      LEStartPageURL = Bootstrapper.readCookie("gcpshop");
    } else if (Bootstrapper.checkCookie("gcpapply")) {
      LEStartPageURL = Bootstrapper.readCookie("gcpapply");
    }
  };

  sendPageData = function() {
    if (typeof omn !== "undefined" && typeof omn.pagename !== "undefined" && typeof omn.hierarchy !== "undefined") {
      hierarchy = omn.hierarchy;
      pageName = omn.pagename;
      sendDataToLP();
    } else {
      omnObjExistCount++;
      if (omnObjExistCount <= 70) {
        setTimeout(function() {
          sendPageData();
        }, 100);
      } else {
        console.log("No omniture data is avaiable");
        sendDataToLP();
      }
    }
  };

  sendDataToLP = function() {
    lpTag.sdes.push({
      "type": "ctmrinfo", //MANDATORY
      "info": {
        "cstatus": pageName, //Pass Page Name here
        "ctype": userType, //Pass Customer Type here
        "customerId": hierarchy, //Pass Omniture Hierarchy here
        "imei": mmpIdValue, //Pass Omniture ID here
        "role": LEStartPageURL, //Pass Entry URL here
        "storeNumber": LERnumCode //Pass Random Number here
      }
    });
  };

  window.lpTag = window.lpTag || {};
  window.lpMTagConfig = window.lpMTagConfig || {};
  window.lpTag.vars = window.lpTag.vars || [];
  window.lpTag.dbs = window.lpTag.dbs || [];
  window.lpTag.sdes = window.lpTag.sdes || [];
  window.lpTag.section = 'corporate-acquisitions';

  //_loadChatWidget();
  Bootstrapper.insertScript(lpURL);
  generateRandomNumber();
  sendStartPageNameURL();
  sendPageData();

  var k = document.getElementById('nextButtonDiv');
  if (k !== null) {
    if (k.childNodes[1] !== undefined) {
      var revenue = "";
      var numOfEmp = "";
      var z = k.childNodes[1];
      z.addEventListener('click', function() {
        console.log("begin: inside listener ");
        [].forEach.call(document.querySelectorAll('#eb96e830-6fee-4993-ac3b-0b3838008ecf :checked'), function(elm) {
          revenueRange = elm.innerText;
          if (revenueRange.indexOf("-$") > 0)
            revenue = revenueRange.split("-$")[1].replace("M", "");
          else
            revenue = elm.innerText;
        });

        [].forEach.call(document.querySelectorAll('#a0393089-3c22-4a77-91d9-6e8c7c0c69a4 :checked'), function(elm) {
          empRange = elm.innerText;
          if (empRange.indexOf("-") > 0)
            numOfEmp = empRange.split("-")[1];
          else
            numOfEmp = empRange;
        });
        var LPCustomerInfo = {
          "type": "ctmrinfo", //MANDATORY
          "info": {
            "balance": revenue, // Revenue
            "companySize": numOfEmp // Company Size
          }
        };
        lpTag.sdes.send(LPCustomerInfo);
        
      });
    }
  }

} 

============================
merchant_us_c2c.js

try{
window.lpTag = window.lpTag || {}; 
window.lpTag.vars = window.lpTag.vars || []; 
window.lpTag.dbs = window.lpTag.dbs || [];
window.lpMTagConfig = window.lpMTagConfig || {};
window.lpTag.sdes = window.lpTag.sdes||[];
window.lpTag.section = 'global merchant';
window.lpTag.tagletSection = 'merchant';

var fileHref = "https://icm.aexp-static.com/Internet/SMC/images/Chat/styles.css";
var ITMCSS = document.createElement("link");
ITMCSS.setAttribute("rel", "stylesheet");
ITMCSS.setAttribute("type", "text/css");
ITMCSS.setAttribute("href", fileHref);
document.getElementsByTagName("head")[0].appendChild(ITMCSS);

if(Bootstrapper.ensEnv === "1"){ //E1 code
Bootstrapper.insertScript("//dicm.intra.aexp.com/Internet/NGMS/global/js/Xcutcomponent.js");
Bootstrapper.insertScript("//dstatic.dev.ipc.us.aexp.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js");
}else if(Bootstrapper.ensEnv === "2" || Bootstrapper.hostName("origin-slgem",0) || Bootstrapper.hostName("icm",0)){  //E2 code
Bootstrapper.insertScript("//qicm.americanexpress.com/Internet/NGMS/global/js/Xcutcomponent.js");
Bootstrapper.insertScript("//qwww.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js");
}else{ //E3 code 
Bootstrapper.insertScript("//icm.aexp-static.com/Internet/NGMS/global/js/Xcutcomponent.js");
Bootstrapper.insertScript("//www.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js");
}
}catch(e){
}

========================

myca_mr_us_c2c.js

var deviceAgent = navigator.userAgent.toLowerCase();
var hostName = window.location.hostname;
var queryParam = window.location.search;
var queryString = queryParam.toLowerCase();
var pathName = window.location.pathname;
var timerCount = 0;


function checkIOAVariable() {
  if (typeof($iOA) !== "undefined") {
    clearInterval(ioaVariableCheck);
    callLpCode();
  } else {
    timerCount++;
    if (timerCount === 6) {
      clearInterval(ioaVariableCheck);
      callLpCode();
    }
  }
}

var bdaasDelayCount = 0;
var loadBdaas = function() {
  if (typeof(isSDEReady) !== "undefined" && isSDEReady === true) {

    var startLETag = function() {
      if (lpTag.start) {
        lpTag.isDom = true;
        lpTag.start();
      } else {
        setTimeout(startLETag, 500);
      }
    };

    startLETag();

  } else {
    bdaasDelayCount++;
    if (bdaasDelayCount <= 50) {
      setTimeout(function() {
        loadBdaas();
      }, 100);
    }
  }
};

var sessionCookie = Bootstrapper.readCookie('amexsessioncookie');

function callLpCode() {
  Bootstrapper.bindPageSpecificCompletion(function() {
    Bootstrapper.bindDOMParsed(function() {
      if (queryString.indexOf('searchkey=theme') < 0) {
        if (typeof(sessionCookie) !== 'undefined' && sessionCookie !== null && sessionCookie.indexOf('|uts=') > 0) {
          window.lpTag = window.lpTag || {};
          window.lpTag.vars = window.lpTag.vars || [];
          window.lpTag.dbs = window.lpTag.dbs || [];
          window.lpMTagConfig = window.lpMTagConfig || {};
          window.lpTag.sdes = window.lpTag.sdes || [];
          window.lpTag.section = "us mr en";
          window.lpTag.tagletSection = "mr";
          if (hostName === "e1qrewards.webqa.ipc.us.aexp.com") {
            window.lpTag.tagletSection = 'us mr en bdaas';
            window.lpTag.section = ["us mr en"];
            var bdaasDelayCount = 0;
            Bootstrapper.insertScript("//dstatic.dev.ipc.us.aexp.com/api/axpi/ensighten/liveengage-lp/bdaas/le-mtagconfig.js");
            Bootstrapper.insertScript("https://icm.aexp-static.com/content/dam/chat/js/bdaasapi.js");

            loadBdaas();
          } else if (hostName === "e2srewards.americanexpress.com" || hostName === "qwww01.extra.americanexpress.com" || hostName === "e2qrewards.americanexpress.com") {
            window.lpTag.tagletSection = 'us mr en bdaas';
            window.lpTag.section = ["us mr en"];

            Bootstrapper.insertScript("//qwww.aexp-static.com/api/axpi/ensighten/liveengage-lp/bdaas/le-mtagconfig.js");
            Bootstrapper.insertScript("https://icm.aexp-static.com/content/dam/chat/js/bdaasapi.js");


            loadBdaas();

          } else if (hostName === "slrewards.americanexpress.com") {
            Bootstrapper.insertScript("//www.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js");
            Bootstrapper.insertScript("//slrewards.americanexpress.com/myca/loyalty/assist/js/loyaltyAssist.js?ver=1.0");
          } else if (hostName === "rewards.americanexpress.com") {
            Bootstrapper.insertScript("//www.aexp-static.com/api/axpi/ensighten/liveengage-lp/le-mtagconfig.js");
            Bootstrapper.insertScript("//rewards.americanexpress.com/myca/loyalty/assist/js/loyaltyAssist.js?ver=1.0");
          }
        }
      }
    });
  });
}
//Disabled Chat(loyaltyAssist js file) for userAgent aexphybrid as per Saravana-Sirisha comuunication - 03/15/2017
if (deviceAgent.indexOf("aexphybrid") < 0) {
  if (typeof($iOA) === "undefined") {
    ioaVariableCheck = setInterval(function() {
      checkIOAVariable();
    }, 500);
  } else {
    callLpCode();
  }
}
